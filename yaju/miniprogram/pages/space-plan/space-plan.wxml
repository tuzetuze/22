<view class="container">
  <!-- 房间信息头部 -->
  <view class="room-header">
    <view class="room-info">
      <text class="room-icon">{{spaceIcon}}</text>
      <view class="room-details">
        <text class="room-name">{{spaceName}}</text>
        <text class="room-subtitle">设置这个房间的装修预算</text>
      </view>
    </view>
  </view>

  <!-- 预算设置卡片 -->
  <view class="budget-card">
    <view class="card-header">
      <text class="card-title">💰 房间预算</text>
      <text class="card-subtitle">为这个房间分配合适的预算</text>
    </view>
    
    <view class="budget-input-section">
      <view class="input-group">
        <text class="input-label">预算金额 (元)</text>
        <input 
          class="budget-input" 
          type="digit" 
          placeholder="如：20000"
          value="{{spaceBudget}}"
          bindinput="onBudgetInput"
          maxlength="10"
          confirm-type="done"
          cursor-spacing="10"
          selection-start="-1"
          selection-end="-1"
        />
      </view>
      
      <!-- 预算参考 -->
      <view class="budget-reference" wx:if="{{totalBudget > 0}}">
        <text class="reference-title">💡 参考建议</text>
        <view class="reference-options">
          <view 
            class="reference-item {{selectedReference === item.percent ? 'selected' : ''}}"
            wx:for="{{budgetReferences}}"
            wx:key="percent"
            bindtap="selectReference"
            data-percent="{{item.percent}}"
            data-amount="{{item.amount}}"
          >
            <text class="reference-label">{{item.label}}</text>
            <text class="reference-amount">￥{{item.amount}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 3D房间预览 -->
  <view class="room-3d-card" wx:if="{{spaceBudget > 0}}">
    <view class="card-header">
      <text class="card-title">🏠 3D预览</text>
      <text class="card-subtitle">查看房间3D布局效果</text>
    </view>
    
    <room-3d 
      room-type="{{spaceType}}"
      room-data="{{roomData}}"
      show-furniture="{{true}}"
      view-mode="perspective"
      bind:furnitureClick="onFurnitureClick"
      bind:roomClick="onRoomClick"
    ></room-3d>
  </view>

  <!-- 装修要点 -->
  <view class="features-card" wx:if="{{spaceBudget > 0}}">
    <view class="card-header">
      <text class="card-title">🔧 装修要点</text>
      <text class="card-subtitle">选择这个房间的装修重点</text>
    </view>
    
    <view class="features-list">
      <view 
        class="feature-item {{item.selected ? 'selected' : ''}}"
        wx:for="{{spaceFeatures}}"
        wx:key="id"
        bindtap="toggleFeature"
        data-id="{{item.id}}"
      >
        <text class="feature-icon">{{item.icon}}</text>
        <text class="feature-name">{{item.name}}</text>
        <text class="feature-check">{{item.selected ? '✓' : '○'}}</text>
      </view>
    </view>
  </view>

  <!-- 底部操作 -->
  <view class="bottom-actions">
    <button class="btn btn-secondary" bindtap="goBack">返回</button>
    <button class="btn btn-primary" bindtap="saveSpacePlan" disabled="{{!canSave}}">
      {{spaceBudget > 0 ? '保存规划' : '设置预算'}}
    </button>
  </view>

  <!-- 成功提示 -->
  <view class="success-tip" wx:if="{{showSuccess}}">
    <view class="success-content">
      <text class="success-icon">🎉</text>
      <text class="success-text">{{spaceName}} 规划完成！</text>
    </view>
  </view>
</view>