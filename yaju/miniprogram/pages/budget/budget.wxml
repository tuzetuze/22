<view class="container">
  <!-- 简化预算概览 -->
  <view class="budget-overview-card">
    <view class="budget-header">
      <text class="page-title">预算管理</text>
      <text class="page-subtitle">简单清晰的预算跟踪</text>
    </view>
    
    <!-- 核心预算信息 -->
    <view class="budget-main">
      <view class="budget-total">
        <text class="budget-label">总预算</text>
        <text class="budget-amount">￥{{totalBudget || 0}}</text>
        <button class="btn-edit" bindtap="setBudget" wx:if="{{totalBudget === 0}}">设置预算</button>
        <button class="btn-edit" bindtap="setBudget" wx:else>修改</button>
      </view>
      
      <view class="budget-usage" wx:if="{{totalBudget > 0}}">
        <view class="usage-bar">
          <view class="usage-fill" style="width: {{usagePercentage > 100 ? 100 : usagePercentage}}%;"></view>
        </view>
        <view class="usage-info">
          <text class="usage-text">已用 ￥{{usedBudget}} / 剩余 ￥{{remainingBudget}}</text>
          <text class="usage-percent">{{usagePercentage}}%</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 房间预算列表 -->
  <view class="spaces-budget" wx:if="{{totalBudget > 0}}">
    <text class="section-title">各房间预算</text>
    
    <view class="space-list" wx:if="{{spaceBudgets.length > 0}}">
      <view 
        class="space-item"
        wx:for="{{spaceBudgets}}"
        wx:key="id"
      >
        <view class="space-info">
          <text class="space-icon">{{item.icon}}</text>
          <text class="space-name">{{item.name}}</text>
        </view>
        <view class="space-budget">
          <text class="budget-text">￥{{item.budget}}</text>
          <view class="mini-progress" wx:if="{{item.budget > 0}}">
            <view class="mini-fill" style="width: {{item.percentage > 100 ? 100 : item.percentage}}%;"></view>
          </view>
        </view>
      </view>
    </view>
    
    <!-- 空状态 -->
    <view class="empty-hint" wx:else>
      <text class="hint-icon">🏠</text>
      <text class="hint-text">去房间页面设置各房间预算</text>
    </view>
  </view>

  <!-- 简单提示 -->
  <view class="simple-tip" wx:if="{{totalBudget === 0}}">
    <view class="tip-content">
      <text class="tip-icon">💡</text>
      <text class="tip-text">先设置总预算，再分配各房间预算，轻松管理装修花费</text>
    </view>
  </view>
</view>

<!-- 设置预算弹窗 -->
<view class="modal-overlay" wx:if="{{showBudgetModal}}" catchtap="closeBudgetModal">
  <view class="modal" catchtap="stopPropagation">
    <view class="modal-header">
      <text class="title-medium">{{totalBudget === 0 ? '设置预算' : '修改预算'}}</text>
    </view>
    <view class="modal-body">
      <view class="input-group">
        <text class="input-label">装修总预算 (元)</text>
        <input 
          class="input-field" 
          type="digit" 
          placeholder="请输入预算金额"
          value="{{tempBudget}}"
          bindinput="onBudgetInput"
          maxlength="10"
          confirm-type="done"
          cursor-spacing="10"
          selection-start="-1"
          selection-end="-1"
        />
      </view>
    </view>
    <view class="modal-footer">
      <button class="btn btn-secondary" bindtap="closeBudgetModal">取消</button>
      <button class="btn btn-primary" bindtap="confirmBudget">确定</button>
    </view>
  </view>
</view>