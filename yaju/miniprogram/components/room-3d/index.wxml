<view class="room-3d-container">
  <!-- 控制面板 -->
  <view class="control-panel">
    <view class="view-controls">
      <button 
        class="control-btn {{viewMode === 'perspective' ? 'active' : ''}}" 
        data-mode="perspective" 
        bindtap="switchView"
        size="mini"
      >透视图</button>
      <button 
        class="control-btn {{viewMode === 'top' ? 'active' : ''}}" 
        data-mode="top" 
        bindtap="switchView"
        size="mini"
      >俯视图</button>
      <button 
        class="control-btn {{viewMode === 'side' ? 'active' : ''}}" 
        data-mode="side" 
        bindtap="switchView"
        size="mini"
      >侧视图</button>
    </view>
    <button 
      class="furniture-toggle {{showFurniture ? 'active' : ''}}" 
      bindtap="toggleFurniture"
      size="mini"
    >{{showFurniture ? '隐藏家具' : '显示家具'}}</button>
  </view>

  <!-- 3D场景容器 -->
  <view class="scene-container">
    <view 
      class="room-3d {{viewMode}}" 
      style="{{customTransform ? 'transform: ' + customTransform : ''}}"
      bindtap="onRoomClick"
      bindtouchstart="onTouchStart"
      bindtouchmove="onTouchMove"
      bindtouchend="onTouchEnd"
    >
      <!-- 房间主体 -->
      <view 
        class="room-body" 
        style="width: {{currentRoom.size.width}}rpx; height: {{currentRoom.size.height}}rpx; background-color: {{currentRoom.color}};"
      >
        <!-- 房间标题 -->
        <view class="room-title">{{currentRoom.name}}</view>
        
        <!-- 房间边框线 -->
        <view class="room-edges">
          <view class="edge edge-top"></view>
          <view class="edge edge-right"></view>
          <view class="edge edge-bottom"></view>
          <view class="edge edge-left"></view>
        </view>

        <!-- 房间装饰元素 -->
        <view class="room-decorations">
          <!-- 门 -->
          <view class="door" wx:if="{{currentRoom.hasDoor !== false}}">
            <view class="door-frame"></view>
            <view class="door-handle"></view>
          </view>
          
          <!-- 窗户 -->
          <view class="window" wx:if="{{currentRoom.hasWindow !== false}}">
            <view class="window-frame"></view>
            <view class="window-glass"></view>
            <view class="window-cross"></view>
          </view>
          
          <!-- 地板纹理 -->
          <view class="floor-pattern">
            <view class="floor-tile" wx:for="{{floorTiles}}" wx:key="index" style="left: {{item.x}}rpx; top: {{item.y}}rpx;"></view>
          </view>
        </view>

        <!-- 家具列表 -->
        <view wx:if="{{showFurniture && currentRoom.furniture}}" class="furniture-container">
          <view 
            wx:for="{{currentRoom.furniture}}" 
            wx:key="index"
            class="furniture furniture-{{item.type}}"
            style="left: {{item.x}}rpx; top: {{item.y}}rpx; width: {{item.width}}rpx; height: {{item.depth}}rpx; background-color: {{furnitureColors[item.type]}};"
            data-furniture="{{item}}"
            bindtap="onFurnitureClick"
          >
            <!-- 家具3D效果 -->
            <view class="furniture-top" style="background-color: {{furnitureColors[item.type]}}"></view>
            <view class="furniture-side" style="background-color: {{furnitureColors[item.type]}}"></view>
            
            <!-- 家具标签 -->
            <view class="furniture-label">{{item.type}}</view>
          </view>
        </view>

        <!-- 房间尺寸标注 -->
        <view class="dimension-labels">
          <view class="dimension-width">{{currentRoom.size.width/10}}cm</view>
          <view class="dimension-height">{{currentRoom.size.depth/10}}cm</view>
        </view>
      </view>

      <!-- 房间侧面 -->
      <view class="room-side" style="background-color: {{currentRoom.color}}"></view>
      <!-- 房间顶面 -->
      <view class="room-top" style="background-color: {{currentRoom.color}}"></view>
    </view>
  </view>

  <!-- 房间信息面板 -->
  <view class="info-panel">
    <view class="info-item">
      <text class="info-label">面积:</text>
      <text class="info-value">{{roomArea}}㎡</text>
    </view>
    <view class="info-item" wx:if="{{currentRoom.style}}">
      <text class="info-label">风格:</text>
      <text class="info-value">{{currentRoom.style}}</text>
    </view>
    <view class="info-item" wx:if="{{currentRoom.mainColor}}">
      <text class="info-label">主色调:</text>
      <view class="color-preview" style="background-color: {{currentRoom.mainColor}}"></view>
    </view>
    <view class="info-item" wx:if="{{viewMode === 'perspective'}}">
      <text class="info-label">💡 提示:</text>
      <text class="info-value">可拖拽旋转查看</text>
    </view>
  </view>
</view>
