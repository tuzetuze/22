<view class="room-3d-container">
  <!-- æ§åˆ¶é¢æ¿ -->
  <view class="control-panel">
    <view class="view-controls">
      <button 
        class="control-btn {{viewMode === 'perspective' ? 'active' : ''}}" 
        data-mode="perspective" 
        bindtap="switchView"
        size="mini"
      >é€è§†å›¾</button>
      <button 
        class="control-btn {{viewMode === 'top' ? 'active' : ''}}" 
        data-mode="top" 
        bindtap="switchView"
        size="mini"
      >ä¿¯è§†å›¾</button>
      <button 
        class="control-btn {{viewMode === 'side' ? 'active' : ''}}" 
        data-mode="side" 
        bindtap="switchView"
        size="mini"
      >ä¾§è§†å›¾</button>
    </view>
    <button 
      class="furniture-toggle {{showFurniture ? 'active' : ''}}" 
      bindtap="toggleFurniture"
      size="mini"
    >{{showFurniture ? 'éšè—å®¶å…·' : 'æ˜¾ç¤ºå®¶å…·'}}</button>
  </view>

  <!-- 3Dåœºæ™¯å®¹å™¨ -->
  <view class="scene-container">
    <view 
      class="room-3d {{viewMode}}" 
      style="{{customTransform ? 'transform: ' + customTransform : ''}}"
      bindtap="onRoomClick"
      bindtouchstart="onTouchStart"
      bindtouchmove="onTouchMove"
      bindtouchend="onTouchEnd"
    >
      <!-- æˆ¿é—´ä¸»ä½“ -->
      <view 
        class="room-body" 
        style="width: {{currentRoom.size.width}}rpx; height: {{currentRoom.size.height}}rpx; background-color: {{currentRoom.color}};"
      >
        <!-- æˆ¿é—´æ ‡é¢˜ -->
        <view class="room-title">{{currentRoom.name}}</view>
        
        <!-- æˆ¿é—´è¾¹æ¡†çº¿ -->
        <view class="room-edges">
          <view class="edge edge-top"></view>
          <view class="edge edge-right"></view>
          <view class="edge edge-bottom"></view>
          <view class="edge edge-left"></view>
        </view>

        <!-- æˆ¿é—´è£…é¥°å…ƒç´  -->
        <view class="room-decorations">
          <!-- é—¨ -->
          <view class="door" wx:if="{{currentRoom.hasDoor !== false}}">
            <view class="door-frame"></view>
            <view class="door-handle"></view>
          </view>
          
          <!-- çª—æˆ· -->
          <view class="window" wx:if="{{currentRoom.hasWindow !== false}}">
            <view class="window-frame"></view>
            <view class="window-glass"></view>
            <view class="window-cross"></view>
          </view>
          
          <!-- åœ°æ¿çº¹ç† -->
          <view class="floor-pattern">
            <view class="floor-tile" wx:for="{{floorTiles}}" wx:key="index" style="left: {{item.x}}rpx; top: {{item.y}}rpx;"></view>
          </view>
        </view>

        <!-- å®¶å…·åˆ—è¡¨ -->
        <view wx:if="{{showFurniture && currentRoom.furniture}}" class="furniture-container">
          <view 
            wx:for="{{currentRoom.furniture}}" 
            wx:key="index"
            class="furniture furniture-{{item.type}}"
            style="left: {{item.x}}rpx; top: {{item.y}}rpx; width: {{item.width}}rpx; height: {{item.depth}}rpx; background-color: {{furnitureColors[item.type]}};"
            data-furniture="{{item}}"
            bindtap="onFurnitureClick"
          >
            <!-- å®¶å…·3Dæ•ˆæœ -->
            <view class="furniture-top" style="background-color: {{furnitureColors[item.type]}}"></view>
            <view class="furniture-side" style="background-color: {{furnitureColors[item.type]}}"></view>
            
            <!-- å®¶å…·æ ‡ç­¾ -->
            <view class="furniture-label">{{item.type}}</view>
          </view>
        </view>

        <!-- æˆ¿é—´å°ºå¯¸æ ‡æ³¨ -->
        <view class="dimension-labels">
          <view class="dimension-width">{{currentRoom.size.width/10}}cm</view>
          <view class="dimension-height">{{currentRoom.size.depth/10}}cm</view>
        </view>
      </view>

      <!-- æˆ¿é—´ä¾§é¢ -->
      <view class="room-side" style="background-color: {{currentRoom.color}}"></view>
      <!-- æˆ¿é—´é¡¶é¢ -->
      <view class="room-top" style="background-color: {{currentRoom.color}}"></view>
    </view>
  </view>

  <!-- æˆ¿é—´ä¿¡æ¯é¢æ¿ -->
  <view class="info-panel">
    <view class="info-item">
      <text class="info-label">é¢ç§¯:</text>
      <text class="info-value">{{roomArea}}ã¡</text>
    </view>
    <view class="info-item" wx:if="{{currentRoom.style}}">
      <text class="info-label">é£æ ¼:</text>
      <text class="info-value">{{currentRoom.style}}</text>
    </view>
    <view class="info-item" wx:if="{{currentRoom.mainColor}}">
      <text class="info-label">ä¸»è‰²è°ƒ:</text>
      <view class="color-preview" style="background-color: {{currentRoom.mainColor}}"></view>
    </view>
    <view class="info-item" wx:if="{{viewMode === 'perspective'}}">
      <text class="info-label">ğŸ’¡ æç¤º:</text>
      <text class="info-value">å¯æ‹–æ‹½æ—‹è½¬æŸ¥çœ‹</text>
    </view>
  </view>
</view>
